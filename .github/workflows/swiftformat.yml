on: pull_request
name: swiftformat
jobs:
  swiftformat:
    name: SwiftFormat
    runs-on: macos-latest
    steps:
    - uses: actions/checkout@master
      with: 
        ref: ${{ github.head_ref }}
    - name: Changed Files Exporter
      uses: futuratrepadeira/changed-files@v3.0.0
      with:
        repo-token: ${{ secrets.GITHUB_TOKEN }}
      id: files
    - name: Run SwiftFormat
      uses: erkekin/SwiftFormat@master
      with: 
        args: "--swiftversion 5 --rules indent,linebreaks --verbose"
        repo-token: ${{ secrets.GITHUB_TOKEN }}
    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v1
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: swiftformat applied
        title: SwiftFormat in Action
        body: This is an auto-generated PR with fixes by swiftformat tool.
        labels: automated pr, swiftformat
        branch: ${{ steps.vars.outputs.branch-name }}
        branch-suffix: none
